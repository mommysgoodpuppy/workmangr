from "std/coretypes" import { EQ, LT, GT };

export let intAdd = (left, right) => {
  nativeAdd(left, right)
};

export let intSub = (left, right) => {
  nativeSub(left, right)
};

export let intMul = (left, right) => {
  nativeMul(left, right)
};

export let intDiv = (left, right) => {
  nativeDiv(left, right)
};

export let intCompare = (left, right) => {
  nativeCmpInt(left, right)
};

export let intEq = (left, right) => {
  match(intCompare(left, right)) {
    EQ => { true },
    _ => { false }
  }
};

export let intNeq = (left, right) => {
  match(intCompare(left, right)) {
    EQ => { false },
    _ => { true }
  }
};

export let intLt = (left, right) => {
  match(intCompare(left, right)) {
    LT => { true },
    _ => { false }
  }
};

export let intLte = (left, right) => {
  match(intCompare(left, right)) {
    GT => { false },
    _ => { true }
  }
};

export let intGt = (left, right) => {
  match(intCompare(left, right)) {
    GT => { true },
    _ => { false }
  }
};

export let intGte = (left, right) => {
  match(intCompare(left, right)) {
    LT => { false },
    _ => { true }
  }
};

-- Modulo operation
export let intMod = (left, right) => {
  intSub(left, intMul(intDiv(left, right), right))
};

-- Check if even
export let intIsEven = (n) => {
  intEq(intMod(n, 2), 0)
};

-- Arithmetic operators
//export infixl 6 + = intAdd;
//export infixl 6 - = intSub;
//export infixl 7 * = intMul;
//export infixl 7 / = intDiv;

-- Comparison operators
//export infix 4 == = intEq;
//export infix 4 != = intNeq;
//export infix 4 < = intLt;
//export infix 4 > = intGt;
//export infix 4 <= = intLte;
//export infix 4 >= = intGte;
